{% load otis_extras %}

{% if curriculum %}

<p>
<button id="hide-completed-units"
	title="Toggle completed unit visibility">
	Toggle âœ…
</button>
<button id="hide-locked-units"
	title="Toggle locked unit visibility">
	Toggle â“
</button>
<span style="font-size: 80%; font-style: italic;">
	Mouse over icons for hints.
</span>
</p>
<script>
$("#hide-completed-units").click(function() {
	$(".unit-completed").toggle();
});
$("#hide-locked-units").click(function() {
	$(".unit-locked").toggle();
});
</script>

<table class="table curriculum">
{% for row in curriculum %}
<tr class="subject{{ row.unit.group.subject }}{% if row.is_approved %} unit-completed{% endif %}{% if not row.is_visible %} unit-locked{% endif %}">
	<td class="number">
	{{ row.number }}
	{% if row.is_approved %}
		<span title="Completed unit">âœ…</span>
	{% elif row.is_submitted and not semester.active %}
		<span title="Completed unit">âœ…</span>
	{% elif row.is_submitted %}
		<span title="Unit pending review">â³</span>
	{% elif row.is_current and semester.active %}
		<span title="Current unit">â–¶ï¸</span>
	{% elif not row.is_visible %}
		<span title="Locked unit">â“</span>
	{% else %}
		<span title="Inactive unit">âœ–ï¸</span>
	{% endif %}
	</td>

	<td class="code">{{ row.unit.position }} {{ row.unit.code }}</td>

	{# Handout/suggest #}
	<td {% if row.is_current %}class="active"{% endif %}>
		{{ row.unit.group.name }}
	</td>
	<td class="emojis">
		{% if row.is_visible %}
			<a class="emoji-link" style="font-size: 80%" title = "Download PDF"
				href="{% view_problems row.unit %}">ğŸ’¾</a>
			<a class="emoji-link" title = "Copy LaTeX"
				href="{% view_tex row.unit %}">ğŸ“‹</a>
			<a class="emoji-link" title = "Add suggestion"
				href="{% url "suggest-new" student.id row.unit.id %}">â•</a>
		{% endif %}
		{% if row.is_visible %}
			<a class="emoji-link" title = "File uploads"
				href="{% url "uploads" student.id row.unit.id %}">
				ğŸ“‚ {{ row.num_uploads|default:"0" }}
			</a>
		{% endif %}
		{% if row.sols_label %}
			<a class="emoji-link" title = "Download solutions"
				href="{% view_solutions row.unit %}">
				{{ row.sols_label }}
			</a>
		{% endif %}
	</td>
</tr>
{% endfor %}
</table>
{% else %}
<i>No curriculum materials yet! Please check back later.</i>

{% endif %}
